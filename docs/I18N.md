# Secrets-LE Internationalization (I18N) Guide

## Goals and Philosophy

- **Inclusive by default**: All user-facing text is localizable.
- **Privacy-first and offline**: No network calls; translations ship with the extension.
- **Predictable keys**: Two namespaces — `manifest.*` for `package.json` UI and `runtime.*` for in-code strings.
- **Safe fallbacks**: English is bundled and used when a key or locale is missing.
- **Translator-friendly**: Consistent placeholders, small focused sentences, and a source catalogue.

**Non-goals**:

- Remote translation fetching or telemetry.
- Complex runtime pluralization logic. We use positional `{0}` placeholders with `vscode-nls`.

---

## File Layout

```
src/i18n/
  package.nls.json        # Base English strings
  package.nls.de.json     # German translations
  package.nls.es.json     # Spanish translations
  package.nls.fr.json     # French translations

package.nls.json          # Base English manifest/runtime keys
package.json              # Wired to l10n field
```

**Notes**:

- Secrets-LE ships with English and partial translations for German, Spanish, and French.
- During packaging, localization files are copied to the extension root by the `vscode:prepublish` script.
- VS Code discovers manifest translations based on the `l10n` field in `package.json` and the `package.nls*.json` naming convention.

**Supported locales**:

- English (base)
- German (`de`)
- Spanish (`es`)
- French (`fr`)

**Future locales planned**:

- Italian (`it`), Japanese (`ja`), Korean (`ko`), Portuguese-Brazil (`pt-br`)
- Russian (`ru`), Ukrainian (`uk`), Vietnamese (`vi`), Chinese-Simplified (`zh-cn`)
- Indonesian (`id`)

---

## Key Namespaces

### Manifest Prefix: `manifest.*`

Used by `package.json` contributions (commands, configuration, menus, capabilities):

```json
{
  "displayName": "%manifest.ext.name%",
  "description": "%manifest.ext.description%",
  "contributes": {
    "commands": [
      {
        "command": "secrets-le.detect",
        "title": "%manifest.command.detect.title%",
        "category": "%manifest.command.category%"
      }
    ]
  }
}
```

### Runtime Prefix: `runtime.*`

Used in TypeScript code for notifications, prompts, and status messages:

```typescript
import * as nls from "vscode-nls";
const localize = nls.config({ messageFormat: nls.MessageFormat.file })();

// Usage
deps.notifier.showWarning(
  localize(
    "runtime.detect.found",
    "Found {0} potential secret(s) in {1} file(s)",
    secretCount,
    filesScanned
  )
);
```

---

## Key Conventions

### Naming Pattern

`<namespace>.<category>.<specific-key>`

**Examples**:

- `manifest.command.detect.title` → "Detect Secrets"
- `runtime.error.parse` → "Failed to parse file: {0}"
- `runtime.detect.progress` → "Scanning workspace for secrets..."

### Placeholders

Use positional placeholders `{0}`, `{1}`, etc. for dynamic values:

```typescript
localize(
  "runtime.detect.found",
  "Found {0} potential secret(s) in {1} file(s)",
  secretCount,
  filesScanned
);
```

**Keep placeholders simple**:

- Numbers: `{0} secrets found`
- File names: `Failed to scan: {0}`
- Counts: `Scanned {0} files`

---

## Adding New Strings

### Step 1: Add to `package.nls.json`

```json
{
  "runtime.detect.workspace-complete": "Workspace scan complete: {0} files scanned, {1} secrets found"
}
```

### Step 2: Use in Code

```typescript
import * as nls from "vscode-nls";
const localize = nls.config({ messageFormat: nls.MessageFormat.file })();

deps.notifier.showInfo(
  localize(
    "runtime.detect.workspace-complete",
    "Workspace scan complete: {0} files scanned, {1} secrets found",
    filesScanned,
    secretsFound
  )
);
```

### Step 3: Test

1. Reload VS Code window
2. Verify the string displays correctly
3. Check Output panel → "Secrets-LE" for any localization warnings

---

## Current Localization Coverage

### Manifest Strings (package.json)

- ✅ Extension name and description
- ✅ All command titles and categories
- ✅ All configuration settings descriptions
- ✅ Capability descriptions

### Runtime Strings (TypeScript code)

- ✅ Error messages (parse, validation, safety, operational)
- ✅ Progress indicators
- ✅ Notification messages
- ✅ Performance warnings
- ✅ Safety recommendations
- ✅ Workspace scanning messages

---

## Future Expansion

When adding new languages:

1. Create `package.nls.<locale>.json` files
2. Copy all keys from `package.nls.json`
3. Translate values, keeping placeholders unchanged
4. Add to `copy:i18n` script in `package.json`
5. Test with VS Code's language picker

**Example structure for German**:

```json
{
  "manifest.ext.name": "Secrets-LE",
  "manifest.ext.description": "Null-Aufwand Geheimnis-Erkennung...",
  "runtime.detect.found": "{0} potenzielle Geheimnisse in {1} Datei(en) gefunden"
}
```

---

## Testing Localization

### Verify English Fallback

1. Remove a key from `package.nls.json`
2. Use the key in code
3. Expect: VS Code shows the key name (safe fallback)

### Check Placeholder Usage

```typescript
// ✅ Good
localize("runtime.detect.found", "Found {0} secrets", count);

// ❌ Bad - placeholder mismatch
localize("runtime.detect.found", "Found secrets", count);
```

### Output Panel Debugging

Enable telemetry logging to see localization events:

```json
{
  "secrets-le.telemetryEnabled": true
}
```

Check Output panel → "Secrets-LE" for warnings about missing keys.

---

## Best Practices

### Keep It Simple

- Short, focused sentences
- One concept per key
- Avoid complex grammar that doesn't translate well

### Consistent Terminology

- "Detect" not "find" or "scan"
- "Secret" not "credential" or "key"
- "Workspace" not "project" or "folder"
- "Sanitize" not "redact" or "mask"

### Context Matters

Provide context in key names:

- `runtime.error.parse` - clearly an error
- `runtime.detect.progress` - progress indicator
- `manifest.command.detect.title` - command palette display

### Avoid Concatenation

Don't build sentences from multiple keys:

```typescript
// ❌ Bad
const msg = localize("runtime.found") + count + localize("runtime.secrets");

// ✅ Good
const msg = localize("runtime.detect.found", "Found {0} secrets", count);
```

---

## Resources

- **VS Code I18N Guide**: https://code.visualstudio.com/api/references/extension-manifest#contributes.localizations
- **vscode-nls documentation**: https://github.com/Microsoft/vscode-nls
- **MessageFormat syntax**: https://messageformat.github.io/messageformat/

---

**Current status**: English base with partial German, Spanish, French  
**Roadmap**: Complete translations for all supported locales in future releases

